<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Four Phases of the Menstrual Cycle</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FDFBF8;
            color: #4A4A4A;
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out;
        }
        .lang-btn { transition: background-color 0.2s, color 0.2s; }
        .lang-btn.active { background-color: #D97706; color: white; }
        .goog-te-banner-frame.skiptranslate { display: none !important; } 
        body { top: 0px !important; }
        .goog-te-gadget-simple {
            background-color: white !important;
            border: 1px solid #FBBF24 !important;
            border-radius: 0.375rem !important;
            padding: 0.25rem 0.5rem !important;
            display: inline-block;
            cursor: pointer;
        }
        .goog-te-gadget-simple span, .goog-te-gadget-simple .goog-te-menu-value span {
            color: #92400E !important;
        }
        .goog-te-gadget-simple .goog-te-menu-value span:last-child { display: none; }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 400px;
            max-height: 50vh;
        }
    </style>
</head>
<body class="antialiased">

    <header class="bg-white/80 backdrop-blur-md sticky top-0 z-50 shadow-sm">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex-shrink-0">
                    <h1 class="text-xl font-bold text-amber-800" data-translate="app_title"></h1>
                </div>
                <div class="flex items-center">
                     <a href="../landing.html" class="text-sm font-medium text-amber-600 hover:text-amber-800" data-translate="back_to_main"></a>
                    <div id="lang-selector" class="flex items-center pl-4 shrink-0">
                        <div id="native-lang-toggle" class="flex items-center">
                            <div class="flex rounded-lg border border-gray-300 p-0.5">
                                <button id="lang-en" class="lang-btn px-3 py-1 text-sm font-semibold rounded-md">EN</button>
                                <button id="lang-es" class="lang-btn px-3 py-1 text-sm font-semibold rounded-md">ES</button>
                            </div>
                            <button id="show-google-translate" class="ml-2 p-2 rounded-lg border border-gray-300 bg-white hover:bg-gray-50">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5h12M9 3v2m4.25 16l-4.25-4.25M19.5 19.5l-4.25-4.25M19.5 19.5l4.25-4.25M19.5 19.5l-4.25 4.25M12 3c-1.242 0-2.48.21-3.634.618m-4.242 4.242A8.964 8.964 0 003 12c0 1.242.21 2.48.618 3.634m4.242 4.242A8.964 8.964 0 0012 21c1.242 0 2.48-.21 3.634-.618m4.242-4.242A8.964 8.964 0 0021 12c0-1.242-.21-2.48-.618-3.634m-4.242-4.242A8.964 8.964 0 0012 3z" /></svg>
                            </button>
                        </div>
                        <div id="google-lang-toggle" class="hidden items-center">
                            <div id="google_translate_element"></div>
                            <button id="back-to-native" class="ml-2 text-sm font-semibold text-amber-600 hover:underline" data-translate="back_button"></button>
                        </div>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="text-center mb-8">
            <h2 class="text-4xl font-bold text-amber-900 mb-2" data-translate="main_title"></h2>
            <p class="text-lg text-gray-600 max-w-3xl mx-auto" data-translate="subtitle"></p>
        </div>

        <div class="bg-white p-6 rounded-lg shadow-md mb-8">
            <h3 class="text-2xl font-semibold mb-4 text-center text-amber-800" data-translate="hormone_chart_title"></h3>
            <div class="chart-container">
                <canvas id="hormoneChart"></canvas>
            </div>
        </div>

        <div id="phases-container" class="space-y-6">
            <!-- Phases will be dynamically inserted here -->
        </div>

        <div class="mt-8 grid md:grid-cols-2 gap-8">
            <div class="bg-white p-6 rounded-lg shadow-md">
                <h3 class="text-2xl font-semibold mb-4 text-amber-800" data-translate="tracking_title"></h3>
                <p class="text-gray-600 mb-4" data-translate="tracking_p1"></p>
                <h4 class="font-bold text-lg mb-2 text-amber-700" data-translate="tracking_how_title"></h4>
                <ul class="list-disc list-inside text-gray-600 space-y-2 text-sm">
                    <li data-translate="tracking_li1"></li>
                    <li data-translate="tracking_li2"></li>
                    <li data-translate="tracking_li3"></li>
                </ul>
            </div>
            <div class="bg-rose-50 p-6 rounded-lg shadow-md border-l-4 border-rose-400">
                <h3 class="text-2xl font-semibold mb-4 text-rose-800" data-translate="doctor_title"></h3>
                <p class="text-rose-700 mb-4" data-translate="doctor_p1"></p>
                <ul class="list-disc list-inside text-rose-700 space-y-2 text-sm">
                    <li data-translate="doctor_li1"></li>
                    <li data-translate="doctor_li2"></li>
                    <li data-translate="doctor_li3"></li>
                    <li data-translate="doctor_li4"></li>
                </ul>
            </div>
        </div>
    </main>

    <footer class="mt-12 py-8 bg-amber-50">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 text-center text-xs text-amber-700">
            <p class="font-bold mb-2" data-translate="footer_disclaimer_title"></p>
            <p data-translate="footer_disclaimer_p1"></p>
            <p class="mt-2" data-translate="footer_disclaimer_p2"></p>
        </div>
    </footer>

    <script type="text/javascript">
        function googleTranslateElementInit() {
          new google.translate.TranslateElement({
            pageLanguage: 'en',
            includedLanguages: 'en,es,zh-CN,hi,ar,fr,ru,pt,bn,de,ja,id,tr,ko,vi,it,pl,nl,th,el,sv,iw,fa,ro,uk,ur,sw,tl,ms,ha',
            layout: google.translate.TranslateElement.InlineLayout.SIMPLE,
            autoDisplay: false
          }, 'google_translate_element');
        }
    </script>
    <script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            let currentLanguage = 'en';
            let hormoneChart = null;
            const nativeLangToggle = document.getElementById('native-lang-toggle');
            const googleLangToggle = document.getElementById('google-lang-toggle');
            const showGoogleTranslateBtn = document.getElementById('show-google-translate');
            const backToNativeBtn = document.getElementById('back-to-native');

            const translations = {
                en: {
                    app_title: "Menstrual Cycle Details",
                    back_to_main: "‚Üê Back to Main Guide",
                    back_button: "Back",
                    main_title: "A Deeper Look at the Menstrual Cycle",
                    subtitle: "The menstrual cycle is more than just your period. It's a complex and powerful process orchestrated by hormones. Understanding each phase can help you recognize your body's patterns and overall health.",
                    hormone_chart_title: "Hormone Fluctuations Throughout the Cycle",
                    chart_label_estrogen: "Estrogen",
                    chart_label_progesterone: "Progesterone",
                    chart_label_lh: "LH (Luteinizing Hormone)",
                    chart_label_fsh: "FSH (Follicle-Stimulating Hormone)",
                    chart_x_axis_label: "Day of Cycle",
                    
                    phase_menstrual_name: "Menstrual Phase",
                    phase_menstrual_duration: "Typically Day 1-5",
                    phase_menstrual_what_happens: "This phase begins on the first day of your period and is the body's way of resetting. Because pregnancy did not occur in the previous cycle, levels of the hormones estrogen and progesterone drop sharply. This hormonal decline signals the uterus to shed its thickened inner lining (the endometrium), resulting in menstrual bleeding.",
                    phase_menstrual_hormones: "Estrogen and progesterone are at their lowest levels. The pituitary gland begins to release Follicle-Stimulating Hormone (FSH) to start preparing for the next cycle.",
                    phase_menstrual_symptoms: "Common symptoms include cramps (as the uterus contracts to shed its lining), bloating, breast tenderness, and mood changes. Fatigue is also common due to hormonal shifts and blood loss.",

                    phase_follicular_name: "Follicular Phase",
                    phase_follicular_duration: "Typically Day 1-13",
                    phase_follicular_what_happens: "This phase starts on the first day of your period (overlapping with the menstrual phase) and ends with ovulation. Guided by FSH, your ovaries begin to mature several small sacs called follicles, each containing an egg. One of these follicles will become dominant and continue to grow. This dominant follicle produces estrogen, which causes the uterine lining to thicken and enrich with blood and nutrients in preparation for a potential pregnancy.",
                    phase_follicular_hormones: "FSH levels are initially high to stimulate follicle growth, then decrease. Estrogen levels rise steadily as the dominant follicle grows, becoming the main hormone of this phase.",
                    phase_follicular_symptoms: "As estrogen levels rise, many women report feeling an increase in energy and mood. You may notice an increase in clear, slippery vaginal discharge as ovulation approaches.",

                    phase_ovulation_name: "Ovulation",
                    phase_ovulation_duration: "Around Day 14 (in a 28-day cycle)",
                    phase_ovulation_what_happens: "This is the main event of the cycle. The high level of estrogen from the follicular phase triggers a rapid surge of Luteinizing Hormone (LH) from the pituitary gland. This LH surge acts like a signal, causing the dominant follicle to rupture and release its mature egg into the fallopian tube. The egg is viable for about 12-24 hours, awaiting fertilization.",
                    phase_ovulation_hormones: "Estrogen peaks, triggering a dramatic surge in LH. FSH also has a smaller surge.",
                    phase_ovulation_symptoms: "Some women experience mild, one-sided pelvic pain (mittelschmerz). Basal body temperature may show a slight dip followed by a sharp rise after ovulation. Cervical mucus becomes very thin, stretchy, and clear, resembling raw egg whites.",

                    phase_luteal_name: "Luteal Phase",
                    phase_luteal_duration: "Typically Day 15-28",
                    phase_luteal_what_happens: "After releasing its egg, the ruptured follicle transforms into a structure called the corpus luteum. The corpus luteum's main job is to produce the hormone progesterone, which makes the uterine lining even thicker and more receptive to a fertilized egg. If the egg is fertilized and implants, the body starts producing hCG (the pregnancy hormone), which maintains the corpus luteum. If pregnancy does not occur, the corpus luteum shrinks and dissolves, causing hormone levels to drop and signaling the start of a new period.",
                    phase_luteal_hormones: "Progesterone is the dominant hormone in this phase, produced by the corpus luteum. Estrogen levels are also elevated but lower than their peak. If pregnancy doesn't occur, both progesterone and estrogen levels fall sharply at the end of this phase.",
                    phase_luteal_symptoms: "The rise in progesterone can cause premenstrual symptoms (PMS) such as bloating, breast tenderness, mood swings, anxiety, and food cravings. Basal body temperature remains elevated during this phase.",
                    
                    what_happens_title: "What's Happening in Your Body?",
                    hormones_title: "Key Hormonal Changes",
                    symptoms_title: "Common Symptoms & Signs",

                    tracking_title: "Tracking Your Cycle: Why It Matters",
                    tracking_p1: "Keeping track of your menstrual cycle is a powerful tool for understanding your body. It helps you establish what's 'normal' for you, making it easier to spot irregularities that might signal a health issue. It's also essential for family planning, whether you are trying to conceive or avoid pregnancy.",
                    tracking_how_title: "How to Track",
                    tracking_li1: "<strong>Calendar Method:</strong> Simply mark the first day of your period on a calendar each month. After a few months, you can calculate your average cycle length.",
                    tracking_li2: "<strong>Symptom Tracking:</strong> Pay attention to physical and emotional changes like mood, energy levels, and cervical mucus. This provides a richer picture of your cycle.",
                    tracking_li3: "<strong>Mobile Apps:</strong> Numerous apps are available to help you log your periods and symptoms, often providing predictions for ovulation and your next period.",

                    doctor_title: "When to See a Doctor",
                    doctor_p1: "While some variation is normal, certain changes in your cycle warrant a conversation with your healthcare provider:",
                    doctor_li1: "Your periods suddenly stop for more than 90 days (and you are not pregnant).",
                    doctor_li2: "Your periods become very irregular after having been regular.",
                    doctor_li3: "You bleed for more than 7 days, or bleed so heavily you soak through a pad or tampon every 1-2 hours.",
                    doctor_li4: "You experience severe pain, bleeding between periods, or bleeding after menopause.",

                    footer_disclaimer_title: "Disclaimer",
                    footer_disclaimer_p1: "The information provided in this guide is for educational purposes only and is not intended as a substitute for professional medical advice, diagnosis, or treatment. Always seek the advice of your physician or other qualified health provider with any questions you may have regarding a medical condition.",
                    footer_disclaimer_p2: "Source Material: Content is adapted from reputable sources including the <a href='https://www.womenshealth.gov/menstrual-cycle' target='_blank' class='underline hover:text-amber-800'>Office on Women's Health</a> and <a href='https://www.acog.org/womens-health/infographics/the-menstrual-cycle' target='_blank' class='underline hover:text-amber-800'>ACOG</a>."
                },
                es: {
                    app_title: "Detalles del Ciclo Menstrual",
                    back_to_main: "‚Üê Volver a la Gu√≠a Principal",
                    back_button: "Volver",
                    main_title: "Una Mirada Profunda al Ciclo Menstrual",
                    subtitle: "El ciclo menstrual es m√°s que solo su per√≠odo. Es un proceso complejo y poderoso orquestado por hormonas. Comprender cada fase puede ayudarla a reconocer los patrones de su cuerpo y su salud en general.",
                    hormone_chart_title: "Fluctuaciones Hormonales a lo Largo del Ciclo",
                    chart_label_estrogen: "Estr√≥geno",
                    chart_label_progesterone: "Progesterona",
                    chart_label_lh: "LH (Hormona Luteinizante)",
                    chart_label_fsh: "FSH (Hormona Fol√≠culo-Estimulante)",
                    chart_x_axis_label: "D√≠a del Ciclo",

                    phase_menstrual_name: "Fase Menstrual",
                    phase_menstrual_duration: "T√≠picamente D√≠as 1-5",
                    phase_menstrual_what_happens: "Esta fase comienza el primer d√≠a de su per√≠odo y es la forma en que el cuerpo se reinicia. Como no ocurri√≥ un embarazo en el ciclo anterior, los niveles de las hormonas estr√≥geno y progesterona caen bruscamente. Esta disminuci√≥n hormonal le indica al √∫tero que desprenda su revestimiento interno engrosado (el endometrio), lo que resulta en el sangrado menstrual.",
                    phase_menstrual_hormones: "El estr√≥geno y la progesterona est√°n en sus niveles m√°s bajos. La gl√°ndula pituitaria comienza a liberar la Hormona Fol√≠culo-Estimulante (FSH) para comenzar a prepararse para el pr√≥ximo ciclo.",
                    phase_menstrual_symptoms: "Los s√≠ntomas comunes incluyen c√≥licos (mientras el √∫tero se contrae para desprender su revestimiento), hinchaz√≥n, sensibilidad en los senos y cambios de humor. La fatiga tambi√©n es com√∫n debido a los cambios hormonales y la p√©rdida de sangre.",

                    phase_follicular_name: "Fase Folicular",
                    phase_follicular_duration: "T√≠picamente D√≠as 1-13",
                    phase_follicular_what_happens: "Esta fase comienza el primer d√≠a de su per√≠odo (superponi√©ndose con la fase menstrual) y termina con la ovulaci√≥n. Guiada por la FSH, sus ovarios comienzan a madurar varios sacos peque√±os llamados fol√≠culos, cada uno con un √≥vulo. Uno de estos fol√≠culos se volver√° dominante y continuar√° creciendo. Este fol√≠culo dominante produce estr√≥geno, lo que hace que el revestimiento uterino se engrose y se enriquezca con sangre y nutrientes en preparaci√≥n para un posible embarazo.",
                    phase_follicular_hormones: "Los niveles de FSH son inicialmente altos para estimular el crecimiento de los fol√≠culos, luego disminuyen. Los niveles de estr√≥geno aumentan constantemente a medida que crece el fol√≠culo dominante, convirti√©ndose en la hormona principal de esta fase.",
                    phase_follicular_symptoms: "A medida que aumentan los niveles de estr√≥geno, muchas mujeres reportan un aumento de energ√≠a y buen humor. Puede notar un aumento en el flujo vaginal claro y resbaladizo a medida que se acerca la ovulaci√≥n.",

                    phase_ovulation_name: "Ovulaci√≥n",
                    phase_ovulation_duration: "Alrededor del D√≠a 14 (en un ciclo de 28 d√≠as)",
                    phase_ovulation_what_happens: "Este es el evento principal del ciclo. El alto nivel de estr√≥geno de la fase folicular desencadena un r√°pido aumento de la Hormona Luteinizante (LH) desde la gl√°ndula pituitaria. Este pico de LH act√∫a como una se√±al, haciendo que el fol√≠culo dominante se rompa y libere su √≥vulo maduro en la trompa de Falopio. El √≥vulo es viable durante unas 12-24 horas, esperando la fertilizaci√≥n.",
                    phase_ovulation_hormones: "El estr√≥geno alcanza su punto m√°ximo, lo que desencadena un aumento dr√°stico de la LH. La FSH tambi√©n tiene un pico m√°s peque√±o.",
                    phase_ovulation_symptoms: "Algunas mujeres experimentan un dolor p√©lvico leve y unilateral (mittelschmerz). La temperatura corporal basal puede mostrar una ligera ca√≠da seguida de un aumento brusco despu√©s de la ovulaci√≥n. El moco cervical se vuelve muy fino, el√°stico y transparente, parecido a la clara de huevo cruda.",

                    phase_luteal_name: "Fase L√∫tea",
                    phase_luteal_duration: "T√≠picamente D√≠as 15-28",
                    phase_luteal_what_happens: "Despu√©s de liberar su √≥vulo, el fol√≠culo roto se transforma en una estructura llamada cuerpo l√∫teo. El trabajo principal del cuerpo l√∫teo es producir la hormona progesterona, que hace que el revestimiento uterino sea a√∫n m√°s grueso y receptivo a un √≥vulo fertilizado. Si el √≥vulo es fertilizado e implantado, el cuerpo comienza a producir hCG (la hormona del embarazo), que mantiene el cuerpo l√∫teo. Si no ocurre el embarazo, el cuerpo l√∫teo se encoge y se disuelve, lo que provoca la ca√≠da de los niveles hormonales y se√±ala el inicio de un nuevo per√≠odo.",
                    phase_luteal_hormones: "La progesterona es la hormona dominante en esta fase, producida por el cuerpo l√∫teo. Los niveles de estr√≥geno tambi√©n est√°n elevados pero m√°s bajos que su pico. Si no ocurre el embarazo, tanto los niveles de progesterona como de estr√≥geno caen bruscamente al final de esta fase.",
                    phase_luteal_symptoms: "El aumento de la progesterona puede causar s√≠ntomas premenstruales (SPM) como hinchaz√≥n, sensibilidad en los senos, cambios de humor, ansiedad y antojos de comida. La temperatura corporal basal permanece elevada durante esta fase.",

                    what_happens_title: "¬øQu√© Sucede en su Cuerpo?",
                    hormones_title: "Cambios Hormonales Clave",
                    symptoms_title: "S√≠ntomas y Signos Comunes",

                    tracking_title: "Seguimiento de su Ciclo: Por Qu√© Importa",
                    tracking_p1: "Llevar un registro de su ciclo menstrual es una herramienta poderosa para comprender su cuerpo. Le ayuda a establecer lo que es 'normal' para usted, facilitando la detecci√≥n de irregularidades que podr√≠an indicar un problema de salud. Tambi√©n es esencial para la planificaci√≥n familiar, ya sea que est√© tratando de concebir o de evitar un embarazo.",
                    tracking_how_title: "C√≥mo Hacer el Seguimiento",
                    tracking_li1: "<strong>M√©todo del Calendario:</strong> Simplemente marque el primer d√≠a de su per√≠odo en un calendario cada mes. Despu√©s de unos meses, puede calcular la duraci√≥n promedio de su ciclo.",
                    tracking_li2: "<strong>Seguimiento de S√≠ntomas:</strong> Preste atenci√≥n a los cambios f√≠sicos y emocionales como el estado de √°nimo, los niveles de energ√≠a y el moco cervical. Esto proporciona una imagen m√°s rica de su ciclo.",
                    tracking_li3: "<strong>Aplicaciones M√≥viles:</strong> Existen numerosas aplicaciones para ayudarla a registrar sus per√≠odos y s√≠ntomas, que a menudo ofrecen predicciones sobre la ovulaci√≥n y su pr√≥ximo per√≠odo.",

                    doctor_title: "Cu√°ndo Consultar a un M√©dico",
                    doctor_p1: "Aunque cierta variaci√≥n es normal, ciertos cambios en su ciclo justifican una conversaci√≥n con su proveedor de atenci√≥n m√©dica:",
                    doctor_li1: "Sus per√≠odos se detienen repentinamente por m√°s de 90 d√≠as (y no est√° embarazada).",
                    doctor_li2: "Sus per√≠odos se vuelven muy irregulares despu√©s de haber sido regulares.",
                    doctor_li3: "Sangra durante m√°s de 7 d√≠as, o sangra tan abundantemente que empapa una toalla sanitaria o tamp√≥n cada 1-2 horas.",
                    doctor_li4: "Experimenta dolor severo, sangrado entre per√≠odos o sangrado despu√©s de la menopausia.",

                    footer_disclaimer_title: "Descargo de Responsabilidad",
                    footer_disclaimer_p1: "La informaci√≥n proporcionada en esta gu√≠a es solo para fines educativos y no pretende ser un sustituto del consejo, diagn√≥stico o tratamiento m√©dico profesional. Siempre busque el consejo de su m√©dico u otro proveedor de salud calificado con cualquier pregunta que pueda tener sobre una condici√≥n m√©dica.",
                    footer_disclaimer_p2: "Material de Origen: El contenido est√° adaptado de fuentes acreditadas como la <a href='https://espanol.womenshealth.gov/menstrual-cycle' target='_blank' class='underline hover:text-amber-800'>Oficina para la Salud de la Mujer</a> y <a href='https://www.acog.org/womens-health/infographics/the-menstrual-cycle' target='_blank' class='underline hover:text-amber-800'>ACOG</a>."
                }
            };
            
            const phaseData = [
                { id: 'menstrual', color: 'rose', icon: 'üíß' },
                { id: 'follicular', color: 'emerald', icon: 'üå±' },
                { id: 'ovulation', color: 'yellow', icon: '‚òÄÔ∏è' },
                { id: 'luteal', color: 'indigo', icon: 'üåô' }
            ];

            const changeLanguage = (lang) => {
                currentLanguage = lang;
                document.documentElement.lang = lang;
                document.getElementById('lang-en').classList.toggle('active', lang === 'en');
                document.getElementById('lang-es').classList.toggle('active', lang === 'es');
                renderContent();
            };

            const renderContent = () => {
                const t = translations[currentLanguage];
                document.querySelectorAll('[data-translate]').forEach(el => {
                    const key = el.dataset.translate;
                    if (t[key]) el.innerHTML = t[key];
                });
                renderPhases();
                renderHormoneChart();
            };

            const renderPhases = () => {
                const t = translations[currentLanguage];
                const container = document.getElementById('phases-container');
                container.innerHTML = phaseData.map(phase => `
                    <div class="bg-white rounded-lg shadow-md overflow-hidden">
                        <button class="accordion-button flex justify-between items-center w-full p-5 text-left font-semibold text-xl text-${phase.color}-800 bg-${phase.color}-50 hover:bg-${phase.color}-100 transition">
                            <div class="flex items-center">
                                <span class="text-3xl mr-4">${phase.icon}</span>
                                <div>
                                    <span data-translate="phase_${phase.id}_name"></span>
                                    <span class="block text-sm font-normal text-${phase.color}-600" data-translate="phase_${phase.id}_duration"></span>
                                </div>
                            </div>
                            <svg class="w-6 h-6 shrink-0 transition-transform duration-300" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>
                        </button>
                        <div class="accordion-content">
                            <div class="p-5 border-t border-${phase.color}-200 grid md:grid-cols-3 gap-6">
                                <div class="md:col-span-1">
                                    <h4 class="font-bold text-lg mb-2 text-${phase.color}-700" data-translate="what_happens_title"></h4>
                                    <p class="text-sm text-gray-600" data-translate="phase_${phase.id}_what_happens"></p>
                                </div>
                                <div class="md:col-span-1">
                                    <h4 class="font-bold text-lg mb-2 text-${phase.color}-700" data-translate="hormones_title"></h4>
                                    <p class="text-sm text-gray-600" data-translate="phase_${phase.id}_hormones"></p>
                                </div>
                                <div class="md:col-span-1">
                                    <h4 class="font-bold text-lg mb-2 text-${phase.color}-700" data-translate="symptoms_title"></h4>
                                    <p class="text-sm text-gray-600" data-translate="phase_${phase.id}_symptoms"></p>
                                </div>
                            </div>
                        </div>
                    </div>
                `).join('');
                // Re-translate the newly created elements
                document.querySelectorAll('[data-translate]').forEach(el => {
                    const key = el.dataset.translate;
                    if (t[key]) el.innerHTML = t[key];
                });
            };

            const renderHormoneChart = () => {
                const t = translations[currentLanguage];
                const ctx = document.getElementById('hormoneChart').getContext('2d');
                const labels = Array.from({ length: 28 }, (_, i) => i + 1);
                
                if (hormoneChart) {
                    hormoneChart.destroy();
                }

                hormoneChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [
                            {
                                label: t.chart_label_estrogen,
                                data: [2, 2, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 10, 4, 5, 6, 6, 7, 7, 8, 8, 7, 6, 5, 4, 3, 2, 2],
                                borderColor: 'rgba(219, 39, 119, 1)',
                                backgroundColor: 'rgba(219, 39, 119, 0.1)',
                                tension: 0.4,
                                borderWidth: 2,
                            },
                            {
                                label: t.chart_label_progesterone,
                                data: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 4, 6, 8, 10, 11, 12, 11, 10, 8, 6, 4, 2, 1, 1],
                                borderColor: 'rgba(124, 58, 237, 1)',
                                backgroundColor: 'rgba(124, 58, 237, 0.1)',
                                tension: 0.4,
                                borderWidth: 2,
                            },
                            {
                                label: t.chart_label_lh,
                                data: [3, 3, 3, 3, 3, 3, 3, 4, 4, 5, 6, 8, 20, 5, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3],
                                borderColor: 'rgba(2, 132, 199, 1)',
                                backgroundColor: 'rgba(2, 132, 199, 0.1)',
                                tension: 0.4,
                                borderWidth: 2,
                            },
                            {
                                label: t.chart_label_fsh,
                                data: [6, 6, 6, 5, 5, 5, 5, 5, 5, 5, 6, 7, 12, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 6, 6],
                                borderColor: 'rgba(5, 150, 105, 1)',
                                backgroundColor: 'rgba(5, 150, 105, 0.1)',
                                tension: 0.4,
                                borderWidth: 2,
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            x: {
                                title: { display: true, text: t.chart_x_axis_label }
                            },
                            y: {
                                beginAtZero: true,
                                title: { display: true, text: 'Relative Hormone Levels' }
                            }
                        },
                        plugins: {
                            tooltip: { mode: 'index', intersect: false },
                        }
                    }
                });
            };

            document.body.addEventListener('click', (e) => {
                if (e.target.matches('.accordion-button, .accordion-button *')) {
                    const button = e.target.closest('.accordion-button');
                    const content = button.nextElementSibling;
                    const icon = button.querySelector('svg');
                    
                    if (content && content.classList.contains('accordion-content')) {
                        if (content.style.maxHeight) {
                            content.style.maxHeight = null;
                            if (icon) icon.style.transform = 'rotate(0deg)';
                        } else {
                            content.style.maxHeight = content.scrollHeight + "px";
                            if (icon) icon.style.transform = 'rotate(180deg)';
                        }
                    }
                }
            });
            
            document.getElementById('lang-en').addEventListener('click', () => changeLanguage('en'));
            document.getElementById('lang-es').addEventListener('click', () => changeLanguage('es'));
            
            showGoogleTranslateBtn.addEventListener('click', () => {
                nativeLangToggle.classList.add('hidden');
                googleLangToggle.classList.remove('hidden');
                googleLangToggle.classList.add('flex');
            });

            backToNativeBtn.addEventListener('click', () => {
                nativeLangToggle.classList.remove('hidden');
                googleLangToggle.classList.add('hidden');
                googleLangToggle.classList.remove('flex');
                const currentGoogleLang = document.querySelector('.goog-te-gadget-simple .goog-te-menu-value span').innerText.toLowerCase();
                if (currentGoogleLang !== 'english') {
                    const langSelect = document.querySelector('.goog-te-gadget-simple');
                    langSelect.value = 'en';
                    langSelect.dispatchEvent(new Event('change'));
                }
                changeLanguage(currentLanguage);
            });

            changeLanguage('en');
        });
    </script>
</body>
</html>
